@import '../../assets/variables.css';

:root {
  --editor-font-size: 14px;
}

/* --- Editor Container --- */
.cm-editor {
    /* Fallback */
    --zoom-level: 1; 

    /* Layout & Font */
    background-color: var(--color-bg-primary, #ffffff);
    color: var(--color-text-primary, #0f172a);
    font-family: var(--editor-font-family, "JetBrains Mono");
    font-size: calc(var(--editor-font-size, 14px) * var(--zoom-level, 1));
    line-height: 1.5; /* Strict line-height for alignment */

    /* Size */
    height: 100%;
    width: 100%;

    transition: background-color 140ms ease, color 140ms ease;
}

.cm-scroller {
    background-color: var(--color-bg-primary, #ffffff);
    height: 100%;
    width: 100%;
    font-family: inherit;
    line-height: inherit;
}

.cm-content {
    color: var(--color-text-primary, #0f172a);
    caret-color: var(--color-text-primary, #0f172a);
    padding: 12px 0; /* Vertical padding */
    min-height: 100%;
    min-width: 100%;
    font-family: inherit;
}

/* --- Gutter Container --- */
.cm-gutters {
    background-color: var(--color-bg-secondary, #64748b);
    color: var(--color-text-secondary, #64748b);
    border-right: 1px solid var(--color-border, #e2e8f0);
    font-family: inherit;
    
    /* Use 'ch' or 'em' so it scales with Zoom */
    min-width: 3ch; 
    padding-left: 0.5em;
    padding-right: 0.5em;
    z-index: 10;
}

/* --- Visual Line Numbers (The Custom Logic) --- */
.cm-visualLineNumbers .vis-line-num-wrapper {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 0;
    
    /* Inherit exact sizing from editor */
    font-size: inherit; 
    line-height: 1.5; /* MATCH EDITOR EXACTLY */
}

.vis-line-num {
    color: var(--color-text-secondary);
    /* Force exact height matching per row */
    height: 1.5em; 
    
    /* Center text vertically in that row */
    display: flex;
    align-items: center; 
    justify-content: flex-end;
}

.vis-line-num-primary { opacity: 1; }
.vis-line-num-sub { opacity: 0.4; } /* The dots for wrapped lines */

/* --- Cursor --- */
.cm-cursor {
    border-left-color: var(--color-text-primary, #0f172a);
    border-left-style: solid;
    border-left-width: 2px;
    height: 1.2em !important;
    margin-top: 0.15em !important;
    transform: none !important;
}

/* --- Syntax Highlighting & Extras --- */
.cm-selectionBackground {
    background-color: var(--color-accent-primary, rgba(59, 130, 246, 0.2));
}

.cm-activeLine {
    background-color: var(--color-bg-tertiary, rgba(248, 250, 252, 0.8));
}

.cm-focused, .cm-editor.cm-focused {
    outline: none;
}