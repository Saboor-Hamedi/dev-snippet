/* =========================================
   1. Container & Layout — Minimalist Frame
   ========================================= */
.mermaid-diagram,
.mermaid-wrapper {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin: 1.25rem 0;
  padding: 0; /* ✅ Removed padding */
  background: transparent; /* ✅ No background */
  border: none; /* ✅ No border */
  border-radius: 0;
  box-shadow: none; /* ✅ No shadow */
  overflow: visible; /* Allow diagrams to breathe */
  min-height: auto;
}

/* Hide raw text until rendered */
.mermaid-diagram:not([data-processed]) {
  opacity: 0 !important;
  visibility: hidden !important;
  height: 0 !important;
  overflow: hidden !important;
}

.mermaid-diagram[data-processed] {
  opacity: 1 !important;
  visibility: visible !important;
}

/* Ensure SVG is transparent */
.mermaid svg {
  background: transparent !important;
}

/* =========================================
   2. Node & Edge Styling — Refined & Light
   ========================================= */
.mermaid .edgePaths .edgePath path {
  stroke-width: 1.5px !important; /* Slightly thinner */
  stroke-linecap: round !important;
  opacity: 0.85;
}

.mermaid .marker {
  fill: var(--color-accent-primary) !important;
  stroke: var(--color-accent-primary) !important;
}

/* Nodes: softer corners, no heavy stroke */
.mermaid g.node rect,
.mermaid g.node polygon,
.mermaid g.node circle,
.mermaid g.node ellipse,
.mermaid g.node path {
  rx: 8px !important;
  ry: 8px !important;
  stroke-width: 1px !important; /* ✅ Thinner stroke */
  stroke: var(--color-border) !important;
  fill: var(--color-bg-secondary) !important;
  transition: all 0.2s ease;
}

.mermaid g.node:hover * {
  stroke-width: 1.25px !important;
  filter: brightness(1.05);
}

/* =========================================
   3. Text — Crisp & Readable
   ========================================= */
.mermaid .node label,
.mermaid .edgeLabel,
.mermaid .cluster-label,
.mermaid .actor {
  font-family:
    'Inter',
    -apple-system,
    BlinkMacSystemFont,
    sans-serif !important;
  font-weight: 500 !important;
  font-size: 13px !important;
  fill: var(--color-text-primary) !important;
  color: var(--color-text-primary) !important;
}

/* Edge labels: subtle background, no padding overload */
.mermaid .edgeLabel {
  font-size: 12px !important;
  font-weight: 500 !important;
  background: var(--color-bg-primary) !important;
  padding: 1px 5px !important; /* ✅ Reduced padding */
  border-radius: 3px !important;
  opacity: 0.95;
}

/* =========================================
   4. ER Diagram — Borderless Cells (Key Fix)
   ========================================= */
/* Remove ALL cell borders & backgrounds */
.mermaid .er rect,
.mermaid .er.attributeBoxOdd rect,
.mermaid .er.attributeBoxEven rect,
.mermaid g.er.attributeBoxOdd rect,
.mermaid g.er rect[fill='#e8e8e8'] {
  stroke: none !important; /* ✅ No borders */
  fill: transparent !important; /* ✅ No cell fill */
  opacity: 1;
}

/* Entity box: subtle outline only */
.mermaid .er.entityBox {
  stroke: var(--color-border) !important;
  stroke-width: 1px !important;
  fill: transparent !important;
  rx: 6px !important;
  ry: 6px !important;
}

/* Titles & labels: clean text */
.mermaid .er.entityLabel {
  font-weight: 600 !important;
  fill: var(--color-text-primary) !important;
}
.mermaid .er.attributeLabel {
  fill: var(--color-text-secondary) !important;
  font-size: 12.5px !important;
}

/* Relationships: light, elegant lines */
.mermaid .er.relationshipLine {
  stroke: var(--color-border) !important;
  stroke-width: 1px !important;
  opacity: 0.6;
}
.mermaid .er.relationshipLabel {
  background: transparent !important;
  padding: 0 !important;
}

/* =========================================
   5. Architecture Layers — Keep Your Colors
   ========================================= */
/* React (Blue) */
.mermaid g.node.react * {
  fill: #e3f2fd !important;
  stroke: #1976d2 !important;
}
/* Electron (Orange) */
.mermaid g.node.electron * {
  fill: #fff8e1 !important;
  stroke: #f57c00 !important;
}
/* Sandbox (Green) */
.mermaid g.node.sandbox * {
  fill: #f1f8e9 !important;
  stroke: #388e3c !important;
}
/* Storage (Grey Dashed) */
.mermaid g.node.storage * {
  fill: #fafafa !important;
  stroke: #616161 !important;
  stroke-dasharray: 4, 4 !important;
}

/* =========================================
   6. Dark Theme Sync
   ========================================= */
/* =========================================
   6. Dark Theme Sync
   ========================================= */
[data-theme='midnight-pro'] .mermaid .node label,
[data-theme='midnight-pro'] .mermaid .edgeLabel,
[data-theme='midnight-pro'] .mermaid .cluster-label,
[data-theme='midnight-pro'] .mermaid .actor,
[data-theme='nebula'] .mermaid .node label,
[data-theme='nebula'] .mermaid .edgeLabel,
[data-theme='nebula'] .mermaid .cluster-label,
[data-theme='nebula'] .mermaid .actor,
[data-theme='forest'] .mermaid .node label,
[data-theme='forest'] .mermaid .edgeLabel,
[data-theme='forest'] .mermaid .cluster-label,
[data-theme='forest'] .mermaid .actor {
  fill: var(--color-text-primary) !important;
}

[data-theme='midnight-pro'] .mermaid .er.entityBox,
[data-theme='midnight-pro'] .mermaid .er.relationshipLine,
[data-theme='nebula'] .mermaid .er.entityBox,
[data-theme='nebula'] .mermaid .er.relationshipLine,
[data-theme='forest'] .mermaid .er.entityBox,
[data-theme='forest'] .mermaid .er.relationshipLine {
  stroke: var(--color-border) !important;
}

/* =========================================
   7. Error Handling — Clean & Helpful
   ========================================= */
.mermaid-error-container {
  padding: 1rem;
  background: rgba(239, 68, 68, 0.04);
  border: 1px solid rgba(239, 68, 68, 0.15);
  border-radius: 8px;
  color: var(--color-text-primary);
  font-family: 'JetBrains Mono', monospace;
  font-size: 12px;
  line-height: 1.5;
  margin: 0.75rem 0;
}

.mermaid-error-title {
  font-weight: 700;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  margin-bottom: 6px;
  opacity: 0.85;
}
